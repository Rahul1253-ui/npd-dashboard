<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>NPD Tracker</title>

<style>
body{font-family:Arial;background:#f4f6f8;padding:15px}
h2{text-align:center;font-size:24px}

/* LOGIN */
#loginBox{
  max-width:350px;
  margin:120px auto;
  background:#fff;
  padding:25px;
  border-radius:10px;
  box-shadow:0 4px 10px rgba(0,0,0,.15);
  text-align:center;
}
#loginBox input{
  width:100%;
  padding:10px;
  font-size:16px;
  margin-top:10px;
}
#loginBox button{
  width:100%;
  margin-top:15px;
  padding:10px;
  font-size:16px;
}

/* DASHBOARD */
.dashboard{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:15px;
  margin-bottom:15px;
}
.card{
  background:#fff;
  padding:18px;
  border-radius:8px;
  text-align:center;
  cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
}
.card h3{font-size:28px;margin:5px 0}
.open{border-left:6px solid #007bff}
.process{border-left:6px solid #ffc107}
.closed{border-left:6px solid #28a745}

/* TABLE */
table{width:100%;border-collapse:collapse;background:#fff;font-size:14px}
th,td{border:1px solid #ccc;padding:8px;text-align:center}
th{background:#2c3e50;color:#fff;position:sticky;top:0}
.container{max-height:70vh;overflow:auto}

.status-open{background:#fff}
.status-process{background:#fff3cd}
.status-closed{background:#d4edda}

.activity{min-height:38px;white-space:pre-line;cursor:pointer;font-size:13px}
.hidden-date{display:none}

/* PROGRESS */
.progress-box{width:100%;background:#e0e0e0;border-radius:10px;height:22px;position:relative}
.progress-bar{height:100%;border-radius:10px;background:#28a745;width:0%}
.progress-text{position:absolute;width:100%;font-weight:bold;font-size:13px}

button{padding:7px 12px;font-size:14px;cursor:pointer}
.logout{float:right;background:#dc3545;color:#fff;border:none}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox">
  <h2>Admin Login</h2>
  <p><b>User:</b> ADMIN</p>
  <input type="password" id="password" placeholder="Enter Password">
  <button onclick="login()">Login</button>
  <p id="error" style="color:red"></p>
</div>

<!-- APP -->
<div id="app" style="display:none">

<button class="logout" onclick="logout()">Logout</button>
<h2>NPD Monitoring Sheet</h2>

<div class="dashboard">
  <div class="card" onclick="filterStatus('All')"><h3 id="total">0</h3>Total</div>
  <div class="card open" onclick="filterStatus('Open')"><h3 id="open">0</h3>Open</div>
  <div class="card process" onclick="filterStatus('In Process')"><h3 id="process">0</h3>In Process</div>
  <div class="card closed" onclick="filterStatus('Closed')"><h3 id="closed">0</h3>Closed</div>
</div>

<button onclick="addRow()">âž• Add Row</button>

<div class="container">
<table id="npdTable">
<thead>
<tr>
<th>Sr</th>
<th>Project</th>
<th>Part No</th>
<th>Enquiry</th>
<th>Feasibility</th>
<th>RM Order</th>
<th>RM Test</th>
<th>Prod Plan</th>
<th>Docs</th>
<th>Final Delivery</th>
<th>Completion</th>
<th>Status</th>
<th>Remarks</th>
<th>Action</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
</div>

<script>
const ADMIN_PASSWORD="admin123";

/* LOGIN */
function login(){
  if(password.value===ADMIN_PASSWORD){
    localStorage.setItem("logged","yes");
    showApp();
  }else error.innerText="Wrong password";
}
function logout(){
  localStorage.removeItem("logged");
  location.reload();
}
function showApp(){
  loginBox.style.display="none";
  app.style.display="block";
  load();
}
if(localStorage.getItem("logged")==="yes") showApp();

/* NPD LOGIC */
let tbody=document.querySelector("tbody");

function activityCell(d=""){
 return `<div class="activity" onclick="openCal(this)">${d}</div>
 <input type="date" class="hidden-date" onchange="saveDate(this)">`;
}
function progressCell(){
 return `<div class="progress-box"><div class="progress-bar"></div>
 <div class="progress-text">0%</div></div>`;
}
function addRow(d={}){
 let r=tbody.insertRow();
 r.innerHTML=`
 <td>${tbody.rows.length}</td>
 <td contenteditable>${d.project||""}</td>
 <td contenteditable>${d.part||""}</td>
 <td><input type="date"></td>
 <td>${activityCell(d.feas)}</td>
 <td>${activityCell(d.rmorder)}</td>
 <td>${activityCell(d.rmtest)}</td>
 <td>${activityCell(d.plan)}</td>
 <td>${activityCell(d.docs)}</td>
 <td>${activityCell(d.delivery)}</td>
 <td>${progressCell()}</td>
 <td>
 <select onchange="updateStatus(this)">
 <option>Open</option><option>In Process</option><option>Closed</option>
 </select></td>
 <td contenteditable>${d.remark||""}</td>
 <td><button onclick="this.closest('tr').remove();save()">ðŸ—‘</button></td>`;
 save();
}
function openCal(div){
 let i=div.nextElementSibling;
 i.showPicker?i.showPicker():i.click();
}
function saveDate(i){
 let b=i.previousElementSibling;
 let l=b.innerText.trim().split("\n").filter(x=>x);
 if(l.length>=5) return;
 b.innerText+=`${l.length==0?"P":"R"+l.length}: ${i.value}\n`;
 updateProgress(i.closest("tr"));
 save();
}
function updateProgress(r){
 let c=0;
 for(let i=4;i<=9;i++)
 if(r.cells[i].querySelector(".activity").innerText.trim()) c++;
 let p=Math.round(c/6*100);
 r.querySelector(".progress-bar").style.width=p+"%";
 r.querySelector(".progress-text").innerText=p+"%";
}
function updateStatus(s){
 let r=s.closest("tr"); r.className="";
 r.classList.add("status-"+s.value.replace(" ","-").toLowerCase());
 save();
}
function save(){
 let d=[];
 [...tbody.rows].forEach(r=>{
 d.push({
 project:r.cells[1].innerText,
 part:r.cells[2].innerText,
 feas:r.cells[4].innerText,
 rmorder:r.cells[5].innerText,
 rmtest:r.cells[6].innerText,
 plan:r.cells[7].innerText,
 docs:r.cells[8].innerText,
 delivery:r.cells[9].innerText,
 status:r.cells[11].children[0].value,
 remark:r.cells[12].innerText
 });
 });
 localStorage.setItem("npd",JSON.stringify(d));
 dashboard();
}
function load(){
 let d=JSON.parse(localStorage.getItem("npd")||"[]");
 d.forEach(x=>addRow(x));
 dashboard();
}
function dashboard(){
 let o=0,p=0,c=0;
 [...tbody.rows].forEach(r=>{
 let s=r.cells[11].children[0].value;
 if(s=="Open")o++; if(s=="In Process")p++; if(s=="Closed")c++;
 });
 total.innerText=o+p+c; open.innerText=o;
 process.innerText=p; closed.innerText=c;
}
function filterStatus(s){
 [...tbody.rows].forEach(r=>{
 let v=r.cells[11].children[0].value;
 r.style.display=(s=="All"||v==s)?"":"none";
 });
}
</script>

</body>
</html>
